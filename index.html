<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, minimal-ui, viewport-fit=cover">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <title>Attrape-les-tous</title>
    <link rel="stylesheet" href="style.css" />
 </head>
 <body>

   <script>
    // ğŸ”’ Blocage si le joueur n'a pas encore mis son pseudo
    const name = localStorage.getItem("playerName");

    if (!name || name.trim().length === 0) {
        window.location.href = "./intro/intro.html";
    }
 </script>

    <!-- ğŸŒ™ MENU PRINCIPAL -->
    <div id="mainMenu" class="menu-visible">
        <div class="menu-panel">
            <h1 class="menu-title">Attrape-les-tous</h1>

             <!-- Annonce BÃªta -->
    <div id="betaAnnouncement" class="announcement">
    <p><strong>Bienvenue dans la version BÃªta d'Attrape-les-tous !</strong></p>
    <p>Veuillez noter que ce jeu est encore en dÃ©veloppement et peut contenir des bugs.</p>
     <p>Pour plus d'infos, Ã©vÃ©nements et mises Ã  jour,pages end game btn quitter lien ko-fi!</p>
    <p>Merci pour votre soutien et vos retours !</p>
    </div>

              <!-- â­ BanniÃ¨re Saison -->
        <div id="seasonBanner" class="season-banner">
            <span class="season-label">ğŸ”¥ Saison 1 â€¢ Nuit des Orbes ğŸ”¥</span>
        </div>


            <div id="playerBadge" class="player-badge hidden"></div>

            <button class="menu-btn" onclick="startNormalMode()">Mode Normal</button>
            <button class="menu-btn" onclick="startTimerMode()">Mode Timer</button>
            <button class="menu-btn" onclick="openShop()">Boutique</button>
            <button class="menu-btn" onclick="openProfile()">Profil Joueur</button>
            <button id="backToEndGame" onclick="goToEndgame()"> end game</button>
        
            
    </div>
</div>


    <div id="menuBottomEffect"></div>

    <!-- ğŸ„ BANNIÃˆRE Ã‰VÃ‰NEMENT -->
    <div id="eventBanner">
        <img src="assets/evenements/noel/event_noel.png" alt="Ã‰vÃ©nement NoÃ«l">
        <p>ğŸ„ Ã‰vÃ©nement de NoÃ«l â€”  disponible en boutique  ! ğŸ gratuit</p>
    </div>

    <!-- ğŸŒ™ Mascotte du menu -->
    <div id="menuMascotteContainer">
        <img id="menuMascotteImg" src="" alt="Mascotte du menu">
    </div>

    <!-- ğŸ’¬ Bulle de dialogue -->
    <div id="menuBubble" class="menu-bubble hidden"></div>

    <!-- === HUD GLOBAL === -->
<div id="hudContainer">

    <!-- HUD Top-left -->
    <div id="hudTopLeft">

        <!-- Points -->
        <div class="hudBox" id="hudPoints">Pts : 0</div>

        <!-- Gemmes -->
        <div class="hudBox" id="hudGems">ğŸ’ 0</div>

        <!-- Combo -->
        <div id="hudCombo">Combo : 0/3</div>

    </div>

    <!-- HUD XP -->
    <div id="xpHud" class="xp-hud">
        <span id="xpText" class="xp-text">Niv. 1 â€“ 0 / 100XP</span>

        <div class="xp-bar-container">
            <div id="xpBarFill" class="xp-bar-fill"></div>
        </div>
    </div>

</div>

<!-- Effet visuel pour COMBO -->
<div id="comboEffect"></div>





    <!-- Boutons rapides -->
    <div id="quickButtons">
        <button id="btnPause" class="quick-btn">â¸ï¸</button>
        <button id="btnMusic" class="quick-btn">ğŸ”Š</button>
        
        
    </div>

    <!-- Timer -->
    <div id="timerBarContainer">
        <div id="timerBar"></div>
    </div>

    <!-- ğŸ® Canvas -->
    <canvas id="gameCanvas"></canvas>

    <!-- ===========================
     ğŸŸ£ OVERLAY PAUSE
 =========================== -->
      <div id="pauseOverlay" class="pause-overlay hidden">
    <div class="pause-box">
        <h2>â¸ï¸ Pause</h2>

        <button class="pause-btn" onclick="closePause()">
            Continuer
        </button>

        <button class="pause-btn" onclick="pauseToMenu()">
            Menu Principal
        </button>

        <button class="pause-btn quit" onclick="quitToMenu()">
            Quitter
        </button>
    </div>
 </div>


     


    <!-- Toast -->
    <div id="levelToast" class="level-toast hidden"></div>

    <!-- Swipe -->
    <div id="bgSwipe"></div>

     <!-- Mascotte dialogues -->
    <div id="dialogMascotte" class="hidden">
        <img id="dialogMascotteImg" src="" alt="">
        <div id="dialogBubble"></div>
    </div>

   



    <!-- PROFIL -->
     
    <div id="profileOverlay" class="profile-overlay hidden">
        <div class="profile-panel">
            <button class="profile-close" onclick="closeProfile()">âœ•</button>
            


            <h2 class="profile-title">Profil du Joueur</h2>

            


            <div class="profile-header">
                <div class="profile-pseudo-container">
                    <div id="profilePseudo" class="profile-pseudo">Joueur</div>
                    <button class="profile-edit-btn" onclick="editPseudo()">âœ Modifier</button>
                </div>

                <div class="profile-title-equipped">
                    <span class="label">Titre :</span>
                    <span id="profileEquippedTitle">Aucun</span>
                    <button class="profile-edit-btn" onclick="openTitleSelector()">ğŸ– Choisir</button>
                </div>
            </div>

            <div class="profile-stats">
                <div class="profile-stat"><span class="stat-label">High Score :</span><span id="profileHighScore">0</span></div>
                <div class="profile-stat"><span class="stat-label">Points cumulÃ©s :</span><span id="profileTotalPoints">0</span></div>
                <div class="profile-stat"><span class="stat-label">Coins :</span><span id="profileCoins">0</span></div>
                <div class="profile-stat"><span class="stat-label">Gems :</span><span id="profileGems">0</span></div>
    
</div>
                <div class="profile-stat"><span class="stat-label">Temps de jeu :</span><span id="profilePlayTime">0h 00m</span></div>
            </div>

            <div class="profile-titles-list">
                <h3 class="titles-label">Titres dÃ©bloquÃ©s :</h3>
                <div id="profileTitlesContainer"></div>
            </div>
        </div>
    </div>

    <!-- SÃ©lecteur de titres -->
<div id="titleSelectorOverlay" class="profile-overlay hidden">
    <div class="profile-panel">

        <button class="profile-close" onclick="closeTitleSelector()">âœ–</button>

        <h2 class="profile-title">Choisir un Titre</h2>

        <div id="titleSelectorList" class="profile-titles-list">
            <!-- Titres gÃ©nÃ©rÃ©s via JS -->
        </div>
    </div>
 </div>

 <!-- Popup pour informer l'utilisateur qu'il n'a pas assez de gemmes -->
<div id="gemNotEnoughPopup" class="gem-popup hidden">
    <div class="gem-popup-content">
        <h3>ğŸ’ Pas assez de gemmes</h3>
        <p></p>
        <button onclick="closeGemPopup()">Fermer</button>
    </div>
 </div>


    <!-- ğŸŒ™ Boutique -->
<div id="shopOverlay" class="shop-overlay hidden">
    <div id="shopPanel" class="shop-panel">
        <!-- Section des gemmes et coins en haut de la boutique -->
<div id="shopCoins" class="shop-coins">ğŸ’° 0</div>

  <div id="shopGems" class="shop-gems">ğŸ’ 0</div>

        <h2>Boutique Nocturne</h2>
        <button id="closeShop" class="close-btn">âœ•</button>

        <div class="shop-tabs">
            <button data-tab="mascotte" class="tab-btn active">ğŸ€ Mascotte</button>
            <button data-tab="orbes" class="tab-btn">ğŸŸ£ Orbes</button>
            <button data-tab="packs" class="tab-btn">ğŸ Packs</button>
        </div>

        <div id="shopContent" class="shop-content">
            <!-- Les skins s'affichent ici -->
        </div>
    </div>
</div>


<!-- Scripts -->
    <script src="js/loader.js"></script>
<script src="js/game.js"></script>    
<script src="js/engine/assetsmap.js"></script>
<script src="js/menuCharacters.js"></script>
<script src="js/shop.js"></script>
    

    </script>
    <!-- Charger assets menu -->
    <script>
        loadAllGameData().then(async () => {
            console.log("âœ” GameData prÃªt !");
            initShop();

            const menuExtras = [
                { id: "menu_mascotte_idle",  src: "assets/images/menu/lyra_idle.png" },
                { id: "menu_mascotte_blink", src: "assets/images/menu/lyra_blink.png" },
            ];

           


            await GameAssets.load(menuExtras);
            showMainMenu();
        })

</script>


</body>
</html>


